(function(){"use strict";var nr=(()=>{var w=self.location.href;return async function(_={}){var b,o=_,M,E,H=new Promise((e,t)=>{M=e,E=t}),B=typeof window=="object",F=typeof importScripts=="function",z=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(z){const{createRequire:e}=await Promise.resolve().then(function(){return vr});var N=e(self.location.href)}var te=!1;o.setup=function(){if(te)return;te=!0,o.initTBB();function e(i,a,l=v=>v){if(a)for(let v of a)i.push_back(l(v));return i}function t(i,a=l=>l){const l=[],v=i.size();for(let m=0;m<v;m++)l.push(a(i.get(m)));return l}function r(i,a=l=>l){const l=[],v=i.size();for(let m=0;m<v;m++){const A=i.get(m),I=A.size(),L=[];for(let x=0;x<I;x++)L.push(a(A.get(x)));l.push(L)}return l}function n(i){return i[0].length<3&&(i=[i]),e(new o.Vector2_vec2,i,a=>e(new o.Vector_vec2,a,l=>l instanceof Array?{x:l[0],y:l[1]}:l))}function s(i){for(let a=0;a<i.size();a++)i.get(a).delete();i.delete()}function u(i){return i[0]instanceof Array?{x:i[0][0],y:i[0][1]}:typeof i[0]=="number"?{x:i[0]||0,y:i[1]||0}:i[0]}function f(i){return i[0]instanceof Array?{x:i[0][0],y:i[0][1],z:i[0][2]}:typeof i[0]=="number"?{x:i[0]||0,y:i[1]||0,z:i[2]||0}:i[0]}function c(i){return i=="EvenOdd"?0:i=="NonZero"?1:i=="Negative"?3:2}function d(i){return i=="Round"?1:i=="Miter"?2:0}const p=o.CrossSection;function h(i,a="Positive"){if(i instanceof p)return i;{const l=n(i),v=new p(l,c(a));return s(l),v}}o.CrossSection.prototype.translate=function(...i){return this._Translate(u(i))},o.CrossSection.prototype.scale=function(i){return typeof i=="number"?this._Scale({x:i,y:i}):this._Scale(u([i]))},o.CrossSection.prototype.mirror=function(i){return this._Mirror(u([i]))},o.CrossSection.prototype.warp=function(i){const a=De(function(v){const m=Z(v,"double"),A=Z(v+8,"double"),I=[m,A];i(I),Ce(v,I[0],"double"),Ce(v+8,I[1],"double")},"vi"),l=this._Warp(a);return je(a),l},o.CrossSection.prototype.decompose=function(){const i=this._Decompose(),a=t(i);return i.delete(),a},o.CrossSection.prototype.bounds=function(){const i=this._Bounds();return{min:["x","y"].map(a=>i.min[a]),max:["x","y"].map(a=>i.max[a])}},o.CrossSection.prototype.offset=function(i,a="Square",l=2,v=0){return this._Offset(i,d(a),l,v)},o.CrossSection.prototype.extrude=function(i,a=0,l=0,v=[1,1],m=!1){v=u([v]);const A=o._Extrude(this._ToPolygons(),i,a,l,v);return m?A.translate([0,0,-i/2]):A},o.CrossSection.prototype.revolve=function(i=0,a=360){return o._Revolve(this._ToPolygons(),i,a)},o.CrossSection.prototype.add=function(i){return this._add(h(i))},o.CrossSection.prototype.subtract=function(i){return this._subtract(h(i))},o.CrossSection.prototype.intersect=function(i){return this._intersect(h(i))},o.CrossSection.prototype.toPolygons=function(){const i=this._ToPolygons(),a=r(i,l=>[l.x,l.y]);return i.delete(),a},o.Manifold.prototype.smoothOut=function(i=60,a=0){return this._SmoothOut(i,a)},o.Manifold.prototype.warp=function(i){const a=De(function(m){const A=Z(m,"double"),I=Z(m+8,"double"),L=Z(m+16,"double"),x=[A,I,L];i(x),Ce(m,x[0],"double"),Ce(m+8,x[1],"double"),Ce(m+16,x[2],"double")},"vi"),l=this._Warp(a);je(a);const v=l.status();if(v.value!==0)throw new o.ManifoldError(v.value);return l},o.Manifold.prototype.calculateNormals=function(i,a=60){return this._CalculateNormals(i,a)},o.Manifold.prototype.setProperties=function(i,a){const l=this.numProp(),v=De(function(A,I,L){const x=[];for(let k=0;k<i;++k)x[k]=Z(A+8*k,"double");const Me=[];for(let k=0;k<3;++k)Me[k]=Z(I+8*k,"double");const Ee=[];for(let k=0;k<l;++k)Ee[k]=Z(L+8*k,"double");a(x,Me,Ee);for(let k=0;k<i;++k)Ce(A+8*k,x[k],"double")},"viii"),m=this._SetProperties(i,v);return je(v),m},o.Manifold.prototype.translate=function(...i){return this._Translate(f(i))},o.Manifold.prototype.rotate=function(i,a,l){return Array.isArray(i)?this._Rotate(...i):this._Rotate(i,a||0,l||0)},o.Manifold.prototype.scale=function(i){return typeof i=="number"?this._Scale({x:i,y:i,z:i}):this._Scale(f([i]))},o.Manifold.prototype.mirror=function(i){return this._Mirror(f([i]))},o.Manifold.prototype.trimByPlane=function(i,a=0){return this._TrimByPlane(f([i]),a)},o.Manifold.prototype.slice=function(i=0){const a=this._Slice(i),l=new p(a,c("Positive"));return s(a),l},o.Manifold.prototype.project=function(){const i=this._Project(),a=new p(i,c("Positive"));return s(i),a},o.Manifold.prototype.split=function(i){const a=this._Split(i),l=t(a);return a.delete(),l},o.Manifold.prototype.splitByPlane=function(i,a=0){const l=this._SplitByPlane(f([i]),a),v=t(l);return l.delete(),v},o.Manifold.prototype.decompose=function(){const i=this._Decompose(),a=t(i);return i.delete(),a},o.Manifold.prototype.boundingBox=function(){const i=this._boundingBox();return{min:["x","y","z"].map(a=>i.min[a]),max:["x","y","z"].map(a=>i.max[a])}};class g{constructor({numProp:a=3,triVerts:l=new Uint32Array,vertProperties:v=new Float32Array,mergeFromVert:m,mergeToVert:A,runIndex:I,runOriginalID:L,faceID:x,halfedgeTangent:Me,runTransform:Ee}={}){this.numProp=a,this.triVerts=l,this.vertProperties=v,this.mergeFromVert=m,this.mergeToVert=A,this.runIndex=I,this.runOriginalID=L,this.faceID=x,this.halfedgeTangent=Me,this.runTransform=Ee}get numTri(){return this.triVerts.length/3}get numVert(){return this.vertProperties.length/this.numProp}get numRun(){return this.runOriginalID.length}merge(){const{changed:a,mesh:l}=o._Merge(this);return Object.assign(this,{...l}),a}verts(a){return this.triVerts.subarray(3*a,3*(a+1))}position(a){return this.vertProperties.subarray(this.numProp*a,this.numProp*a+3)}extras(a){return this.vertProperties.subarray(this.numProp*a+3,this.numProp*(a+1))}tangent(a){return this.halfedgeTangent.subarray(4*a,4*(a+1))}transform(a){const l=new Array(16);for(const v of[0,1,2,3])for(const m of[0,1,2])l[4*v+m]=this.runTransform[12*a+3*v+m];return l[15]=1,l}}o.Mesh=g,o.Manifold.prototype.getMesh=function(i=-1){return new g(this._GetMeshJS(i))},o.ManifoldError=function(a,...l){let v="Unknown error";switch(a){case o.status.NonFiniteVertex.value:v="Non-finite vertex";break;case o.status.NotManifold.value:v="Not manifold";break;case o.status.VertexOutOfBounds.value:v="Vertex index out of bounds";break;case o.status.PropertiesWrongLength.value:v="Properties have wrong length";break;case o.status.MissingPositionProperties.value:v="Less than three properties";break;case o.status.MergeVectorsDifferentLengths.value:v="Merge vectors have different lengths";break;case o.status.MergeIndexOutOfBounds.value:v="Merge index out of bounds";break;case o.status.TransformWrongLength.value:v="Transform vector has wrong length";break;case o.status.RunIndexWrongLength.value:v="Run index vector has wrong length";break;case o.status.FaceIDWrongLength.value:v="Face ID vector has wrong length";case o.status.InvalidConstruction.value:v="Manifold constructed with invalid parameters"}const m=Error.apply(this,[v,...l]);m.name=this.name="ManifoldError",this.message=m.message,this.stack=m.stack,this.code=a},o.ManifoldError.prototype=Object.create(Error.prototype,{constructor:{value:o.ManifoldError,writable:!0,configurable:!0}}),o.CrossSection=function(i,a="Positive"){const l=n(i),v=new p(l,c(a));return s(l),v},o.CrossSection.ofPolygons=function(i,a="Positive"){return new o.CrossSection(i,a)},o.CrossSection.square=function(...i){let a;i.length==0?a={x:1,y:1}:typeof i[0]=="number"?a={x:i[0],y:i[0]}:a=u(i);const l=i[1]||!1;return o._Square(a,l)},o.CrossSection.circle=function(i,a=0){return o._Circle(i,a)};function C(i){return function(...a){a.length==1&&(a=a[0]);const l=new o.Vector_crossSection;for(const m of a)l.push_back(h(m));const v=o["_crossSection"+i](l);return l.delete(),v}}o.CrossSection.compose=C("Compose"),o.CrossSection.union=C("UnionN"),o.CrossSection.difference=C("DifferenceN"),o.CrossSection.intersection=C("IntersectionN");function V(i,a){e(i,a,l=>l instanceof Array?{x:l[0],y:l[1]}:l)}o.CrossSection.hull=function(...i){i.length==1&&(i=i[0]);let a=new o.Vector_vec2;for(const v of i)if(v instanceof p)o._crossSectionCollectVertices(a,v);else if(v instanceof Array&&v.length==2&&typeof v[0]=="number")a.push_back({x:v[0],y:v[1]});else if(v.x)a.push_back(v);else{const A=v[0].length==2&&typeof v[0][0]=="number"||v[0].x?[v]:v;for(const I of A)V(a,I)}const l=o._crossSectionHullPoints(a);return a.delete(),l},o.CrossSection.prototype=Object.create(p.prototype),Object.defineProperty(o.CrossSection,Symbol.hasInstance,{get:()=>i=>i instanceof p});const W=o.Manifold;o.Manifold=function(i){const a=new W(i),l=a.status();if(l.value!==0)throw new o.ManifoldError(l.value);return a},o.Manifold.ofMesh=function(i){return new o.Manifold(i)},o.Manifold.tetrahedron=function(){return o._Tetrahedron()},o.Manifold.cube=function(...i){let a;i.length==0?a={x:1,y:1,z:1}:typeof i[0]=="number"?a={x:i[0],y:i[0],z:i[0]}:a=f(i);const l=i[1]||!1;return o._Cube(a,l)},o.Manifold.cylinder=function(i,a,l=-1,v=0,m=!1){return o._Cylinder(i,a,l,v,m)},o.Manifold.sphere=function(i,a=0){return o._Sphere(i,a)},o.Manifold.smooth=function(i,a=[]){const l=new o.Vector_smoothness;e(l,a);const v=o._Smooth(i,l);return l.delete(),v},o.Manifold.extrude=function(i,a,l=0,v=0,m=[1,1],A=!1){return(i instanceof p?i:o.CrossSection(i,"Positive")).extrude(a,l,v,m,A)},o.Manifold.revolve=function(i,a=0,l=360){return(i instanceof p?i:o.CrossSection(i,"Positive")).revolve(a,l)},o.Manifold.reserveIDs=function(i){return o._ReserveIDs(i)},o.Manifold.compose=function(i){const a=new o.Vector_manifold;e(a,i);const l=o._manifoldCompose(a);return a.delete(),l};function Y(i){return function(...a){a.length==1&&(a=a[0]);const l=new o.Vector_manifold;for(const m of a)l.push_back(m);const v=o["_manifold"+i+"N"](l);return l.delete(),v}}o.Manifold.union=Y("Union"),o.Manifold.difference=Y("Difference"),o.Manifold.intersection=Y("Intersection"),o.Manifold.levelSet=function(i,a,l,v=0,m=-1){const A={min:{x:a.min[0],y:a.min[1],z:a.min[2]},max:{x:a.max[0],y:a.max[1],z:a.max[2]}},I=De(function(x){const Me=Z(x,"double"),Ee=Z(x+8,"double"),k=Z(x+16,"double");return i([Me,Ee,k])},"di"),L=o._LevelSet(I,A,l,v,m);return je(I),L};function ee(i,a){e(i,a,l=>l instanceof Array?{x:l[0],y:l[1],z:l[2]}:l)}o.Manifold.hull=function(...i){i.length==1&&(i=i[0]);let a=new o.Vector_vec3;for(const v of i)v instanceof W?o._manifoldCollectVertices(a,v):v instanceof Array&&v.length==3&&typeof v[0]=="number"?a.push_back({x:v[0],y:v[1],z:v[2]}):v.x?a.push_back(v):ee(a,v);const l=o._manifoldHullPoints(a);return a.delete(),l},o.Manifold.prototype=Object.create(W.prototype),Object.defineProperty(o.Manifold,Symbol.hasInstance,{get:()=>i=>i instanceof W}),o.triangulate=function(i,a=-1){const l=n(i),v=t(o._Triangulate(l,a),m=>[m[0],m[1],m[2]]);return s(l),v}};var ve=Object.assign({},o),R="";function he(e){return o.locateFile?o.locateFile(e,R):R+e}var J,O;if(z){var q=N("fs"),He=N("path");R=N("url").fileURLToPath(new URL("/auto-kdk/assets/manifold-BrJGmODQ.js",self.location.href)),O=e=>{e=$e(e)?new URL(e):He.normalize(e);var t=q.readFileSync(e);return t},J=(e,t=!0)=>(e=$e(e)?new URL(e):He.normalize(e),new Promise((r,n)=>{q.readFile(e,t?void 0:"utf8",(s,u)=>{s?n(s):r(t?u.buffer:u)})})),!o.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2)}else(B||F)&&(F?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),w&&(R=w),R.startsWith("blob:")?R="":R=R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1),F&&(O=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),J=e=>$e(e)?new Promise((t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{(n.status==200||n.status==0&&n.response)&&r(n.response),t(n.status)},n.onerror=t,n.send(null)}):fetch(e,{credentials:"same-origin"}).then(t=>t.ok?t.arrayBuffer():Promise.reject(new Error(t.status+" : "+t.url))));o.print||console.log.bind(console);var ce=o.printErr||console.error.bind(console);Object.assign(o,ve),ve=null,o.arguments&&o.arguments,o.thisProgram&&o.thisProgram,o.quit&&o.quit;var le;o.wasmBinary&&(le=o.wasmBinary);var we,Be=!1,P,j,re,ye,ne,T,fe,de;function Le(){var e=we.buffer;o.HEAP8=P=new Int8Array(e),o.HEAP16=re=new Int16Array(e),o.HEAPU8=j=new Uint8Array(e),o.HEAPU16=ye=new Uint16Array(e),o.HEAP32=ne=new Int32Array(e),o.HEAPU32=T=new Uint32Array(e),o.HEAPF32=fe=new Float32Array(e),o.HEAPF64=de=new Float64Array(e)}var ze=[],Ne=[],We=[];function qe(){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;)ut(o.preRun.shift());pt(ze)}function pe(){pt(Ne)}function Ge(){if(o.postRun)for(typeof o.postRun=="function"&&(o.postRun=[o.postRun]);o.postRun.length;)lt(o.postRun.shift());pt(We)}function ut(e){ze.unshift(e)}function ct(e){Ne.unshift(e)}function lt(e){We.unshift(e)}var y=0,S=null;function me(e){var t;y++,(t=o.monitorRunDependencies)==null||t.call(o,y)}function ft(e){var r;if(y--,(r=o.monitorRunDependencies)==null||r.call(o,y),y==0&&S){var t=S;S=null,t()}}function X(e){var r;(r=o.onAbort)==null||r.call(o,e),e="Aborted("+e+")",ce(e),Be=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw E(t),t}var dt="data:application/octet-stream;base64,",Je=e=>e.startsWith(dt),$e=e=>e.startsWith("file://");function xe(){if(o.locateFile){var e="manifold.wasm";return Je(e)?e:he(e)}return new URL("/auto-kdk/assets/manifold-CUOyaTWM.wasm",self.location.href).href}var Xe;function Wt(e){if(e==Xe&&le)return new Uint8Array(le);if(O)return O(e);throw"both async and sync fetching of the wasm failed"}function hr(e){return le?Promise.resolve().then(()=>Wt(e)):J(e).then(t=>new Uint8Array(t),()=>Wt(e))}function xt(e,t,r){return hr(e).then(n=>WebAssembly.instantiate(n,t)).then(r,n=>{ce(`failed to asynchronously prepare wasm: ${n}`),X(n)})}function yr(e,t,r,n){return!e&&typeof WebAssembly.instantiateStreaming=="function"&&!Je(t)&&!$e(t)&&!z&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(s=>{var u=WebAssembly.instantiateStreaming(s,r);return u.then(n,function(f){return ce(`wasm streaming compile failed: ${f}`),ce("falling back to ArrayBuffer instantiation"),xt(t,r,n)})}):xt(t,r,n)}function mr(){return{a:Qn}}function gr(){var e=mr();function t(n,s){return Q=n.exports,Q=Yn(Q),we=Q.J,Le(),Ae=Q.M,ct(Q.K),ft(),Q}me();function r(n){t(n.instance)}if(o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(n){ce(`Module.instantiateWasm callback failed with error: ${n}`),E(n)}return Xe||(Xe=xe()),yr(le,Xe,e,r).catch(E),{}}var pt=e=>{for(;e.length>0;)e.shift()(o)};function Z(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":return P[e>>>0];case"i8":return P[e>>>0];case"i16":return re[e>>>1>>>0];case"i32":return ne[e>>>2>>>0];case"i64":X("to do getValue(i64) use WASM_BIGINT");case"float":return fe[e>>>2>>>0];case"double":return de[e>>>3>>>0];case"*":return T[e>>>2>>>0];default:X(`invalid type for getValue: ${t}`)}}o.noExitRuntime;function Ce(e,t,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":P[e>>>0]=t;break;case"i8":P[e>>>0]=t;break;case"i16":re[e>>>1>>>0]=t;break;case"i32":ne[e>>>2>>>0]=t;break;case"i64":X("to do setValue(i64) use WASM_BIGINT");case"float":fe[e>>>2>>>0]=t;break;case"double":de[e>>>3>>>0]=t;break;case"*":T[e>>>2>>>0]=t;break;default:X(`invalid type for setValue: ${r}`)}}class _r{constructor(t){this.excPtr=t,this.ptr=t-24}set_type(t){T[this.ptr+4>>>2>>>0]=t}get_type(){return T[this.ptr+4>>>2>>>0]}set_destructor(t){T[this.ptr+8>>>2>>>0]=t}get_destructor(){return T[this.ptr+8>>>2>>>0]}set_caught(t){t=t?1:0,P[this.ptr+12>>>0]=t}get_caught(){return P[this.ptr+12>>>0]!=0}set_rethrown(t){t=t?1:0,P[this.ptr+13>>>0]=t}get_rethrown(){return P[this.ptr+13>>>0]!=0}init(t,r){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(r)}set_adjusted_ptr(t){T[this.ptr+16>>>2>>>0]=t}get_adjusted_ptr(){return T[this.ptr+16>>>2>>>0]}get_exception_ptr(){var t=tr(this.get_type());if(t)return T[this.excPtr>>>2>>>0];var r=this.get_adjusted_ptr();return r!==0?r:this.excPtr}}var kt=0;function br(e,t,r){e>>>=0,t>>>=0,r>>>=0;var n=new _r(e);throw n.init(t,r),kt=e,kt}var Pr=()=>{X("")},Ze={},vt=e=>{for(;e.length;){var t=e.pop(),r=e.pop();r(t)}};function ke(e){return this.fromWireType(T[e>>>2>>>0])}var Te={},ge={},Ke={},Rt,Qe=e=>{throw new Rt(e)},_e=(e,t,r)=>{e.forEach(function(c){Ke[c]=t});function n(c){var d=r(c);d.length!==e.length&&Qe("Mismatched type converter count");for(var p=0;p<e.length;++p)oe(e[p],d[p])}var s=new Array(t.length),u=[],f=0;t.forEach((c,d)=>{ge.hasOwnProperty(c)?s[d]=ge[c]:(u.push(c),Te.hasOwnProperty(c)||(Te[c]=[]),Te[c].push(()=>{s[d]=ge[c],++f,f===u.length&&n(s)}))}),u.length===0&&n(s)},wr=function(e){e>>>=0;var t=Ze[e];delete Ze[e];var r=t.rawConstructor,n=t.rawDestructor,s=t.fields,u=s.map(f=>f.getterReturnType).concat(s.map(f=>f.setterArgumentType));_e([e],u,f=>{var c={};return s.forEach((d,p)=>{var h=d.fieldName,g=f[p],C=d.getter,V=d.getterContext,W=f[p+s.length],Y=d.setter,ee=d.setterContext;c[h]={read:i=>g.fromWireType(C(V,i)),write:(i,a)=>{var l=[];Y(ee,i,W.toWireType(l,a)),vt(l)}}}),[{name:t.name,fromWireType:d=>{var p={};for(var h in c)p[h]=c[h].read(d);return n(d),p},toWireType:(d,p)=>{for(var h in c)if(!(h in p))throw new TypeError(`Missing field: "${h}"`);var g=r();for(h in c)c[h].write(g,p[h]);return d!==null&&d.push(n,g),g},argPackAdvance:ie,readValueFromPointer:ke,destructorFunction:n}]})};function $r(e,t,r,n,s){}var Cr=()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Ot=e},Ot,U=e=>{for(var t="",r=e;j[r>>>0];)t+=Ot[j[r++>>>0]];return t},Se,$=e=>{throw new Se(e)};function Tr(e,t,r={}){var n=t.name;if(e||$(`type "${n}" must have a positive integer typeid pointer`),ge.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;$(`Cannot register type '${n}' twice`)}if(ge[e]=t,delete Ke[e],Te.hasOwnProperty(e)){var s=Te[e];delete Te[e],s.forEach(u=>u())}}function oe(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Tr(e,t,r)}var ie=8;function Sr(e,t,r,n){e>>>=0,t>>>=0,t=U(t),oe(e,{name:t,fromWireType:function(s){return!!s},toWireType:function(s,u){return u?r:n},argPackAdvance:ie,readValueFromPointer:function(s){return this.fromWireType(j[s>>>0])},destructorFunction:null})}var Fr=e=>({count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}),ht=e=>{function t(r){return r.$$.ptrType.registeredClass.name}$(t(e)+" instance already deleted")},yt=!1,Vt=e=>{},Ar=e=>{e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)},It=e=>{e.count.value-=1;var t=e.count.value===0;t&&Ar(e)},Dt=(e,t,r)=>{if(t===r)return e;if(r.baseClass===void 0)return null;var n=Dt(e,t,r.baseClass);return n===null?null:r.downcast(n)},jt={},Mr=()=>Object.keys(Ve).length,Er=()=>{var e=[];for(var t in Ve)Ve.hasOwnProperty(t)&&e.push(Ve[t]);return e},Re=[],mt=()=>{for(;Re.length;){var e=Re.pop();e.$$.deleteScheduled=!1,e.delete()}},Oe,Wr=e=>{Oe=e,Re.length&&Oe&&Oe(mt)},xr=()=>{o.getInheritedInstanceCount=Mr,o.getLiveInheritedInstances=Er,o.flushPendingDeletes=mt,o.setDelayFunction=Wr},Ve={},kr=(e,t)=>{for(t===void 0&&$("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t},Rr=(e,t)=>(t=kr(e,t),Ve[t]),Ye=(e,t)=>{(!t.ptrType||!t.ptr)&&Qe("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,n=!!t.smartPtr;return r!==n&&Qe("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Ie(Object.create(e,{$$:{value:t,writable:!0}}))};function Or(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=Rr(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function s(){return this.isSmartPointer?Ye(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Ye(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var u=this.registeredClass.getActualType(t),f=jt[u];if(!f)return s.call(this);var c;this.isConst?c=f.constPointerType:c=f.pointerType;var d=Dt(t,this.registeredClass,c.registeredClass);return d===null?s.call(this):this.isSmartPointer?Ye(c.registeredClass.instancePrototype,{ptrType:c,ptr:d,smartPtrType:this,smartPtr:e}):Ye(c.registeredClass.instancePrototype,{ptrType:c,ptr:d})}var Ie=e=>typeof FinalizationRegistry>"u"?(Ie=t=>t,e):(yt=new FinalizationRegistry(t=>{It(t.$$)}),Ie=t=>{var r=t.$$,n=!!r.smartPtr;if(n){var s={$$:r};yt.register(t,s,t)}return t},Vt=t=>yt.unregister(t),Ie(e)),Vr=()=>{Object.assign(et.prototype,{isAliasOf(e){if(!(this instanceof et)||!(e instanceof et))return!1;var t=this.$$.ptrType.registeredClass,r=this.$$.ptr;e.$$=e.$$;for(var n=e.$$.ptrType.registeredClass,s=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)s=n.upcast(s),n=n.baseClass;return t===n&&r===s},clone(){if(this.$$.ptr||ht(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Ie(Object.create(Object.getPrototypeOf(this),{$$:{value:Fr(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e},delete(){this.$$.ptr||ht(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$("Object already scheduled for deletion"),Vt(this),It(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||ht(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$("Object already scheduled for deletion"),Re.push(this),Re.length===1&&Oe&&Oe(mt),this.$$.deleteScheduled=!0,this}})};function et(){}var Fe=(e,t)=>Object.defineProperty(t,"name",{value:e}),Ut=(e,t,r)=>{if(e[t].overloadTable===void 0){var n=e[t];e[t]=function(...s){return e[t].overloadTable.hasOwnProperty(s.length)||$(`Function '${r}' called with an invalid number of arguments (${s.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[s.length].apply(this,s)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}},gt=(e,t,r)=>{o.hasOwnProperty(e)?((r===void 0||o[e].overloadTable!==void 0&&o[e].overloadTable[r]!==void 0)&&$(`Cannot register public name '${e}' twice`),Ut(o,e,e),o.hasOwnProperty(r)&&$(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),o[e].overloadTable[r]=t):(o[e]=t,r!==void 0&&(o[e].numArguments=r))},Ir=48,Dr=57,jr=e=>{if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=Ir&&t<=Dr?`_${e}`:e};function Ur(e,t,r,n,s,u,f,c){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=s,this.getActualType=u,this.upcast=f,this.downcast=c,this.pureVirtualFunctions=[]}var _t=(e,t,r)=>{for(;t!==r;)t.upcast||$(`Expected null or instance of ${r.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e};function Hr(e,t){if(t===null)return this.isReference&&$(`null is not a valid ${this.name}`),0;t.$$||$(`Cannot pass "${Ct(t)}" as a ${this.name}`),t.$$.ptr||$(`Cannot pass deleted object as a pointer of type ${this.name}`);var r=t.$$.ptrType.registeredClass,n=_t(t.$$.ptr,r,this.registeredClass);return n}function Br(e,t){var r;if(t===null)return this.isReference&&$(`null is not a valid ${this.name}`),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;(!t||!t.$$)&&$(`Cannot pass "${Ct(t)}" as a ${this.name}`),t.$$.ptr||$(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&$(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var n=t.$$.ptrType.registeredClass;if(r=_t(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&$("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:$(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var s=t.clone();r=this.rawShare(r,D.toHandle(()=>s.delete())),e!==null&&e.push(this.rawDestructor,r)}break;default:$("Unsupporting sharing policy")}return r}function Lr(e,t){if(t===null)return this.isReference&&$(`null is not a valid ${this.name}`),0;t.$$||$(`Cannot pass "${Ct(t)}" as a ${this.name}`),t.$$.ptr||$(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&$(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var r=t.$$.ptrType.registeredClass,n=_t(t.$$.ptr,r,this.registeredClass);return n}var zr=()=>{Object.assign(tt.prototype,{getPointee(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},destructor(e){var t;(t=this.rawDestructor)==null||t.call(this,e)},argPackAdvance:ie,readValueFromPointer:ke,fromWireType:Or})};function tt(e,t,r,n,s,u,f,c,d,p,h){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=s,this.pointeeType=u,this.sharingPolicy=f,this.rawGetPointee=c,this.rawConstructor=d,this.rawShare=p,this.rawDestructor=h,!s&&t.baseClass===void 0?n?(this.toWireType=Hr,this.destructorFunction=null):(this.toWireType=Lr,this.destructorFunction=null):this.toWireType=Br}var Ht=(e,t,r)=>{o.hasOwnProperty(e)||Qe("Replacing nonexistent public symbol"),o[e].overloadTable!==void 0&&r!==void 0?o[e].overloadTable[r]=t:(o[e]=t,o[e].argCount=r)},Nr=(e,t,r)=>{e=e.replace(/p/g,"i");var n=o["dynCall_"+e];return n(t,...r)},Ae,rt=e=>Ae.get(e),qr=(e,t,r=[])=>{if(e.includes("j"))return Nr(e,t,r);var n=rt(t)(...r);return e[0]=="p"?n>>>0:n},Bt=(e,t)=>(...r)=>qr(e,t,r),K=(e,t)=>{e=U(e);function r(){return e.includes("j")||e.includes("p")?Bt(e,t):rt(t)}var n=r();return typeof n!="function"&&$(`unknown function pointer with signature ${e}: ${t}`),n},Gr=(e,t)=>{var r=Fe(t,function(n){this.name=t,this.message=n;var s=new Error(n).stack;s!==void 0&&(this.stack=this.toString()+`
`+s.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},r},Lt,zt=e=>{var t=er(e),r=U(t);return ue(t),r},nt=(e,t)=>{var r=[],n={};function s(u){if(!n[u]&&!ge[u]){if(Ke[u]){Ke[u].forEach(s);return}r.push(u),n[u]=!0}}throw t.forEach(s),new Lt(`${e}: `+r.map(zt).join([", "]))};function Jr(e,t,r,n,s,u,f,c,d,p,h,g,C){e>>>=0,t>>>=0,r>>>=0,n>>>=0,s>>>=0,u>>>=0,f>>>=0,c>>>=0,d>>>=0,p>>>=0,h>>>=0,g>>>=0,C>>>=0,h=U(h),u=K(s,u),c&&(c=K(f,c)),p&&(p=K(d,p)),C=K(g,C);var V=jr(h);gt(V,function(){nt(`Cannot construct ${h} due to unbound types`,[n])}),_e([e,t,r],n?[n]:[],W=>{var I;W=W[0];var Y,ee;n?(Y=W.registeredClass,ee=Y.instancePrototype):ee=et.prototype;var i=Fe(h,function(...L){if(Object.getPrototypeOf(this)!==a)throw new Se("Use 'new' to construct "+h);if(l.constructor_body===void 0)throw new Se(h+" has no accessible constructor");var x=l.constructor_body[L.length];if(x===void 0)throw new Se(`Tried to invoke ctor of ${h} with invalid number of parameters (${L.length}) - expected (${Object.keys(l.constructor_body).toString()}) parameters instead!`);return x.apply(this,L)}),a=Object.create(ee,{constructor:{value:i}});i.prototype=a;var l=new Ur(h,i,a,C,Y,u,c,p);l.baseClass&&((I=l.baseClass).__derivedClasses??(I.__derivedClasses=[]),l.baseClass.__derivedClasses.push(l));var v=new tt(h,l,!0,!1,!1),m=new tt(h+"*",l,!1,!1,!1),A=new tt(h+" const*",l,!1,!0,!1);return jt[e]={pointerType:m,constPointerType:A},Ht(V,i),[v,m,A]})}var bt=(e,t)=>{for(var r=[],n=0;n<e;n++)r.push(T[t+n*4>>>2>>>0]);return r};function Nt(e){for(var t=1;t<e.length;++t)if(e[t]!==null&&e[t].destructorFunction===void 0)return!0;return!1}function qt(e,t){if(!(e instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof e} which is not a function`);var r=Fe(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var n=new r,s=e.apply(n,t);return s instanceof Object?s:n}function Xr(e,t,r,n){for(var s=Nt(e),u=e.length,f="",c="",d=0;d<u-2;++d)f+=(d!==0?", ":"")+"arg"+d,c+=(d!==0?", ":"")+"arg"+d+"Wired";var p=`
        return function (${f}) {
        if (arguments.length !== ${u-2}) {
          throwBindingError('function ' + humanName + ' called with ' + arguments.length + ' arguments, expected ${u-2}');
        }`;s&&(p+=`var destructors = [];
`);var h=s?"destructors":"null",g=["humanName","throwBindingError","invoker","fn","runDestructors","retType","classParam"];t&&(p+="var thisWired = classParam['toWireType']("+h+`, this);
`);for(var d=0;d<u-2;++d)p+="var arg"+d+"Wired = argType"+d+"['toWireType']("+h+", arg"+d+`);
`,g.push("argType"+d);if(t&&(c="thisWired"+(c.length>0?", ":"")+c),p+=(r||n?"var rv = ":"")+"invoker(fn"+(c.length>0?", ":"")+c+`);
`,s)p+=`runDestructors(destructors);
`;else for(var d=t?1:2;d<e.length;++d){var C=d===1?"thisWired":"arg"+(d-2)+"Wired";e[d].destructorFunction!==null&&(p+=`${C}_dtor(${C});
`,g.push(`${C}_dtor`))}return r&&(p+=`var ret = retType['fromWireType'](rv);
return ret;
`),p+=`}
`,[g,p]}function Pt(e,t,r,n,s,u){var f=t.length;f<2&&$("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var c=t[1]!==null&&r!==null,d=Nt(t),p=t[0].name!=="void",h=[e,$,n,s,vt,t[0],t[1]],g=0;g<f-2;++g)h.push(t[g+2]);if(!d)for(var g=c?1:2;g<t.length;++g)t[g].destructorFunction!==null&&h.push(t[g].destructorFunction);let[C,V]=Xr(t,c,p,u);C.push(V);var W=qt(Function,C)(...h);return Fe(e,W)}var Zr=function(e,t,r,n,s,u){e>>>=0,r>>>=0,n>>>=0,s>>>=0,u>>>=0;var f=bt(t,r);s=K(n,s),_e([],[e],c=>{c=c[0];var d=`constructor ${c.name}`;if(c.registeredClass.constructor_body===void 0&&(c.registeredClass.constructor_body=[]),c.registeredClass.constructor_body[t-1]!==void 0)throw new Se(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${c.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return c.registeredClass.constructor_body[t-1]=()=>{nt(`Cannot construct ${c.name} due to unbound types`,f)},_e([],f,p=>(p.splice(1,0,null),c.registeredClass.constructor_body[t-1]=Pt(d,p,null,s,u),[])),[]})},Gt=e=>{e=e.trim();const t=e.indexOf("(");return t!==-1?e.substr(0,t):e},Kr=function(e,t,r,n,s,u,f,c,d){e>>>=0,t>>>=0,n>>>=0,s>>>=0,u>>>=0,f>>>=0;var p=bt(r,n);t=U(t),t=Gt(t),u=K(s,u),_e([],[e],h=>{h=h[0];var g=`${h.name}.${t}`;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),c&&h.registeredClass.pureVirtualFunctions.push(t);function C(){nt(`Cannot call ${g} due to unbound types`,p)}var V=h.registeredClass.instancePrototype,W=V[t];return W===void 0||W.overloadTable===void 0&&W.className!==h.name&&W.argCount===r-2?(C.argCount=r-2,C.className=h.name,V[t]=C):(Ut(V,t,g),V[t].overloadTable[r-2]=C),_e([],p,Y=>{var ee=Pt(g,Y,h,u,f,d);return V[t].overloadTable===void 0?(ee.argCount=r-2,V[t]=ee):V[t].overloadTable[r-2]=ee,[]}),[]})},wt=[],ae=[];function $t(e){e>>>=0,e>9&&--ae[e+1]===0&&(ae[e]=void 0,wt.push(e))}var Qr=()=>ae.length/2-5-wt.length,Yr=()=>{ae.push(0,1,void 0,1,null,1,!0,1,!1,1),o.count_emval_handles=Qr},D={toValue:e=>(e||$("Cannot use deleted val. handle = "+e),ae[e]),toHandle:e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const t=wt.pop()||ae.length;return ae[t]=e,ae[t+1]=1,t}}}},en={name:"emscripten::val",fromWireType:e=>{var t=D.toValue(e);return $t(e),t},toWireType:(e,t)=>D.toHandle(t),argPackAdvance:ie,readValueFromPointer:ke,destructorFunction:null};function Jt(e){return e>>>=0,oe(e,en)}var tn=(e,t,r)=>{switch(t){case 1:return r?function(n){return this.fromWireType(P[n>>>0])}:function(n){return this.fromWireType(j[n>>>0])};case 2:return r?function(n){return this.fromWireType(re[n>>>1>>>0])}:function(n){return this.fromWireType(ye[n>>>1>>>0])};case 4:return r?function(n){return this.fromWireType(ne[n>>>2>>>0])}:function(n){return this.fromWireType(T[n>>>2>>>0])};default:throw new TypeError(`invalid integer width (${t}): ${e}`)}};function rn(e,t,r,n){e>>>=0,t>>>=0,r>>>=0,t=U(t);function s(){}s.values={},oe(e,{name:t,constructor:s,fromWireType:function(u){return this.constructor.values[u]},toWireType:(u,f)=>f.value,argPackAdvance:ie,readValueFromPointer:tn(t,r,n),destructorFunction:null}),gt(t,s)}var ot=(e,t)=>{var r=ge[e];return r===void 0&&$(`${t} has unknown type ${zt(e)}`),r};function nn(e,t,r){e>>>=0,t>>>=0;var n=ot(e,"enum");t=U(t);var s=n.constructor,u=Object.create(n.constructor.prototype,{value:{value:r},constructor:{value:Fe(`${n.name}_${t}`,function(){})}});s.values[r]=u,s[t]=u}var Ct=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},on=(e,t)=>{switch(t){case 4:return function(r){return this.fromWireType(fe[r>>>2>>>0])};case 8:return function(r){return this.fromWireType(de[r>>>3>>>0])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},sn=function(e,t,r){e>>>=0,t>>>=0,r>>>=0,t=U(t),oe(e,{name:t,fromWireType:n=>n,toWireType:(n,s)=>s,argPackAdvance:ie,readValueFromPointer:on(t,r),destructorFunction:null})};function an(e,t,r,n,s,u,f){e>>>=0,r>>>=0,n>>>=0,s>>>=0,u>>>=0;var c=bt(t,r);e=U(e),e=Gt(e),s=K(n,s),gt(e,function(){nt(`Cannot call ${e} due to unbound types`,c)},t-1),_e([],c,d=>{var p=[d[0],null].concat(d.slice(1));return Ht(e,Pt(e,p,null,s,u,f),t-1),[]})}var un=(e,t,r)=>{switch(t){case 1:return r?n=>P[n>>>0]:n=>j[n>>>0];case 2:return r?n=>re[n>>>1>>>0]:n=>ye[n>>>1>>>0];case 4:return r?n=>ne[n>>>2>>>0]:n=>T[n>>>2>>>0];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}};function cn(e,t,r,n,s){e>>>=0,t>>>=0,r>>>=0,t=U(t);var u=h=>h;if(n===0){var f=32-8*r;u=h=>h<<f>>>f}var c=t.includes("unsigned"),d=(h,g)=>{},p;c?p=function(h,g){return d(g,this.name),g>>>0}:p=function(h,g){return d(g,this.name),g},oe(e,{name:t,fromWireType:u,toWireType:p,argPackAdvance:ie,readValueFromPointer:un(t,r,n!==0),destructorFunction:null})}function ln(e,t,r){e>>>=0,r>>>=0;var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],s=n[t];function u(f){var c=T[f>>>2>>>0],d=T[f+4>>>2>>>0];return new s(P.buffer,d,c)}r=U(r),oe(e,{name:r,fromWireType:u,argPackAdvance:ie,readValueFromPointer:u},{ignoreDuplicateRegistrations:!0})}function fn(e,t){e>>>=0,Jt(e)}var dn=(e,t,r,n)=>{if(r>>>=0,!(n>0))return 0;for(var s=r,u=r+n-1,f=0;f<e.length;++f){var c=e.charCodeAt(f);if(c>=55296&&c<=57343){var d=e.charCodeAt(++f);c=65536+((c&1023)<<10)|d&1023}if(c<=127){if(r>=u)break;t[r++>>>0]=c}else if(c<=2047){if(r+1>=u)break;t[r++>>>0]=192|c>>6,t[r++>>>0]=128|c&63}else if(c<=65535){if(r+2>=u)break;t[r++>>>0]=224|c>>12,t[r++>>>0]=128|c>>6&63,t[r++>>>0]=128|c&63}else{if(r+3>=u)break;t[r++>>>0]=240|c>>18,t[r++>>>0]=128|c>>12&63,t[r++>>>0]=128|c>>6&63,t[r++>>>0]=128|c&63}}return t[r>>>0]=0,r-s},pn=(e,t,r)=>dn(e,j,t,r),vn=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t},Xt=typeof TextDecoder<"u"?new TextDecoder:void 0,hn=(e,t,r)=>{t>>>=0;for(var n=t+r,s=t;e[s]&&!(s>=n);)++s;if(s-t>16&&e.buffer&&Xt)return Xt.decode(e.subarray(t,s));for(var u="";t<s;){var f=e[t++];if(!(f&128)){u+=String.fromCharCode(f);continue}var c=e[t++]&63;if((f&224)==192){u+=String.fromCharCode((f&31)<<6|c);continue}var d=e[t++]&63;if((f&240)==224?f=(f&15)<<12|c<<6|d:f=(f&7)<<18|c<<12|d<<6|e[t++]&63,f<65536)u+=String.fromCharCode(f);else{var p=f-65536;u+=String.fromCharCode(55296|p>>10,56320|p&1023)}}return u},yn=(e,t)=>(e>>>=0,e?hn(j,e,t):"");function mn(e,t){e>>>=0,t>>>=0,t=U(t);var r=t==="std::string";oe(e,{name:t,fromWireType(n){var s=T[n>>>2>>>0],u=n+4,f;if(r)for(var c=u,d=0;d<=s;++d){var p=u+d;if(d==s||j[p>>>0]==0){var h=p-c,g=yn(c,h);f===void 0?f=g:(f+="\0",f+=g),c=p+1}}else{for(var C=new Array(s),d=0;d<s;++d)C[d]=String.fromCharCode(j[u+d>>>0]);f=C.join("")}return ue(n),f},toWireType(n,s){s instanceof ArrayBuffer&&(s=new Uint8Array(s));var u,f=typeof s=="string";f||s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Int8Array||$("Cannot pass non-string to std::string"),r&&f?u=vn(s):u=s.length;var c=At(4+u+1),d=c+4;if(T[c>>>2>>>0]=u,r&&f)pn(s,d,u+1);else if(f)for(var p=0;p<u;++p){var h=s.charCodeAt(p);h>255&&(ue(d),$("String has UTF-16 code units that do not fit in 8 bits")),j[d+p>>>0]=h}else for(var p=0;p<u;++p)j[d+p>>>0]=s[p];return n!==null&&n.push(ue,c),c},argPackAdvance:ie,readValueFromPointer:ke,destructorFunction(n){ue(n)}})}var Zt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,gn=(e,t)=>{for(var r=e,n=r>>1,s=n+t/2;!(n>=s)&&ye[n>>>0];)++n;if(r=n<<1,r-e>32&&Zt)return Zt.decode(j.subarray(e>>>0,r>>>0));for(var u="",f=0;!(f>=t/2);++f){var c=re[e+f*2>>>1>>>0];if(c==0)break;u+=String.fromCharCode(c)}return u},_n=(e,t,r)=>{if(r??(r=2147483647),r<2)return 0;r-=2;for(var n=t,s=r<e.length*2?r/2:e.length,u=0;u<s;++u){var f=e.charCodeAt(u);re[t>>>1>>>0]=f,t+=2}return re[t>>>1>>>0]=0,t-n},bn=e=>e.length*2,Pn=(e,t)=>{for(var r=0,n="";!(r>=t/4);){var s=ne[e+r*4>>>2>>>0];if(s==0)break;if(++r,s>=65536){var u=s-65536;n+=String.fromCharCode(55296|u>>10,56320|u&1023)}else n+=String.fromCharCode(s)}return n},wn=(e,t,r)=>{if(t>>>=0,r??(r=2147483647),r<4)return 0;for(var n=t,s=n+r-4,u=0;u<e.length;++u){var f=e.charCodeAt(u);if(f>=55296&&f<=57343){var c=e.charCodeAt(++u);f=65536+((f&1023)<<10)|c&1023}if(ne[t>>>2>>>0]=f,t+=4,t+4>s)break}return ne[t>>>2>>>0]=0,t-n},$n=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t},Cn=function(e,t,r){e>>>=0,t>>>=0,r>>>=0,r=U(r);var n,s,u,f;t===2?(n=gn,s=_n,f=bn,u=c=>ye[c>>>1>>>0]):t===4&&(n=Pn,s=wn,f=$n,u=c=>T[c>>>2>>>0]),oe(e,{name:r,fromWireType:c=>{for(var d=T[c>>>2>>>0],p,h=c+4,g=0;g<=d;++g){var C=c+4+g*t;if(g==d||u(C)==0){var V=C-h,W=n(h,V);p===void 0?p=W:(p+="\0",p+=W),h=C+t}}return ue(c),p},toWireType:(c,d)=>{typeof d!="string"&&$(`Cannot pass non-string to C++ string type ${r}`);var p=f(d),h=At(4+p+t);return T[h>>>2>>>0]=p/t,s(d,h+4,p+t),c!==null&&c.push(ue,h),h},argPackAdvance:ie,readValueFromPointer:ke,destructorFunction(c){ue(c)}})};function Tn(e,t,r,n,s,u){e>>>=0,t>>>=0,r>>>=0,n>>>=0,s>>>=0,u>>>=0,Ze[e]={name:U(t),rawConstructor:K(r,n),rawDestructor:K(s,u),fields:[]}}function Sn(e,t,r,n,s,u,f,c,d,p){e>>>=0,t>>>=0,r>>>=0,n>>>=0,s>>>=0,u>>>=0,f>>>=0,c>>>=0,d>>>=0,p>>>=0,Ze[e].fields.push({fieldName:U(t),getterReturnType:r,getter:K(n,s),getterContext:u,setterArgumentType:f,setter:K(c,d),setterContext:p})}var Fn=function(e,t){e>>>=0,t>>>=0,t=U(t),oe(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:(r,n)=>{}})};function An(e,t,r){return e>>>=0,t>>>=0,r>>>=0,j.copyWithin(e>>>0,t>>>0,t+r>>>0)}var Kt=(e,t,r)=>{var n=[],s=e.toWireType(n,r);return n.length&&(T[t>>>2>>>0]=D.toHandle(n)),s};function Mn(e,t,r){return e>>>=0,t>>>=0,r>>>=0,e=D.toValue(e),t=ot(t,"emval::as"),Kt(t,r,e)}var En={},Qt=e=>{var t=En[e];return t===void 0?U(e):t},Tt=[];function Wn(e,t,r,n,s){return e>>>=0,t>>>=0,r>>>=0,n>>>=0,s>>>=0,e=Tt[e],t=D.toValue(t),r=Qt(r),e(t,t[r],n,s)}function xn(e,t){return e>>>=0,t>>>=0,e=D.toValue(e),t=D.toValue(t),e==t}var kn=e=>{var t=Tt.length;return Tt.push(e),t},Rn=(e,t)=>{for(var r=new Array(e),n=0;n<e;++n)r[n]=ot(T[t+n*4>>>2>>>0],"parameter "+n);return r};function On(e,t,r){t>>>=0;var n=Rn(e,t),s=n.shift();e--;var u=`return function (obj, func, destructorsRef, args) {
`,f=0,c=[];r===0&&c.push("obj");for(var d=["retType"],p=[s],h=0;h<e;++h)c.push("arg"+h),d.push("argType"+h),p.push(n[h]),u+=`  var arg${h} = argType${h}.readValueFromPointer(args${f?"+"+f:""});
`,f+=n[h].argPackAdvance;var g=r===1?"new func":"func.call";u+=`  var rv = ${g}(${c.join(", ")});
`,s.isVoid||(d.push("emval_returnValue"),p.push(Kt),u+=`  return emval_returnValue(retType, destructorsRef, rv);
`),u+=`};
`,d.push(u);var C=qt(Function,d)(...p),V=`methodCaller<(${n.map(W=>W.name).join(", ")}) => ${s.name}>`;return kn(Fe(V,C))}function Vn(e,t){return e>>>=0,t>>>=0,e=D.toValue(e),t=D.toValue(t),D.toHandle(e[t])}function In(e){e>>>=0,e>9&&(ae[e+1]+=1)}function Dn(e){return e>>>=0,D.toHandle(Qt(e))}function jn(){return D.toHandle({})}function Un(e){e>>>=0;var t=D.toValue(e);vt(t),$t(e)}function Hn(e,t,r){e>>>=0,t>>>=0,r>>>=0,e=D.toValue(e),t=D.toValue(t),r=D.toValue(r),e[t]=r}function Bn(e,t){e>>>=0,t>>>=0,e=ot(e,"_emval_take_value");var r=e.readValueFromPointer(t);return D.toHandle(r)}var Ln=()=>4294901760,zn=e=>{var t=we.buffer,r=(e-t.byteLength+65535)/65536;try{return we.grow(r),Le(),1}catch{}};function Nn(e){e>>>=0;var t=j.length,r=Ln();if(e>r)return!1;for(var n=(d,p)=>d+(p-d%p)%p,s=1;s<=4;s*=2){var u=t*(1+.2/s);u=Math.min(u,e+100663296);var f=Math.min(r,n(Math.max(e,u),65536)),c=zn(f);if(c)return!0}return!1}var Yt=(e,t)=>{e<128?t.push(e):t.push(e%128|128,e>>7)},qn=e=>{for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:e[0]=="v"?[]:[t[e[0]]]},n=1;n<e.length;++n)r.parameters.push(t[e[n]]);return r},Gn=(e,t)=>{var r=e.slice(0,1),n=e.slice(1),s={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),Yt(n.length,t);for(var u=0;u<n.length;++u)t.push(s[n[u]]);r=="v"?t.push(0):t.push(1,s[r])},Jn=(e,t)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(qn(t),e);var r=[1];Gn(t,r);var n=[0,97,115,109,1,0,0,0,1];Yt(r.length,n),n.push(...r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var s=new WebAssembly.Module(new Uint8Array(n)),u=new WebAssembly.Instance(s,{e:{f:e}}),f=u.exports.f;return f},Xn=(e,t)=>{if(be)for(var r=e;r<e+t;r++){var n=rt(r);n&&be.set(n,r)}},be,Zn=e=>(be||(be=new WeakMap,Xn(0,Ae.length)),be.get(e)||0),St=[],Kn=()=>{if(St.length)return St.pop();try{Ae.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}return Ae.length-1},Ft=(e,t)=>Ae.set(e,t),De=(e,t)=>{var r=Zn(e);if(r)return r;var n=Kn();try{Ft(n,e)}catch(u){if(!(u instanceof TypeError))throw u;var s=Jn(e,t);Ft(n,s)}return be.set(e,n),n},je=e=>{be.delete(rt(e)),Ft(e,null),St.push(e)};Rt=o.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},Cr(),Se=o.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},Vr(),xr(),zr(),Lt=o.UnboundTypeError=Gr(Error,"UnboundTypeError"),Yr();var Qn={i:br,D:Pr,n:wr,C:$r,H:Sr,h:Jr,g:Zr,a:Kr,G:Jt,t:rn,f:nn,x:sn,c:an,j:cn,e:ln,k:fn,w:mn,s:Cn,o:Tn,l:Sn,I:Fn,F:An,v:Mn,z:Wn,b:$t,m:xn,y:On,B:Vn,u:In,q:Dn,A:jn,p:Un,r:Hn,d:Bn,E:Nn},Q=gr(),er=e=>(er=Q.L)(e),ue=e=>(ue=Q.N)(e),At=e=>(At=Q.O)(e),tr=e=>(tr=Q.P)(e);function Yn(e){e=Object.assign({},e);var t=n=>s=>n(s)>>>0,r=n=>()=>n()>>>0;return e.L=t(e.L),e.O=t(e.O),e._emscripten_stack_alloc=t(e._emscripten_stack_alloc),e.emscripten_stack_get_current=r(e.emscripten_stack_get_current),e}o.addFunction=De,o.removeFunction=je;var it;S=function e(){it||rr(),it||(S=e)};function rr(){if(y>0||(qe(),y>0))return;function e(){var t;it||(it=!0,o.calledRun=!0,!Be&&(pe(),M(o),(t=o.onRuntimeInitialized)==null||t.call(o),Ge()))}o.setStatus?(o.setStatus("Running..."),setTimeout(function(){setTimeout(function(){o.setStatus("")},1),e()},1)):e()}if(o.preInit)for(typeof o.preInit=="function"&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return rr(),b=H,b}})();const or=["cube","cylinder","sphere","tetrahedron","extrude","revolve","compose","union","difference","intersection","levelSet","smooth","ofMesh","hull"],ir=["add","subtract","intersect","decompose","warp","transform","translate","rotate","scale","mirror","calculateCurvature","calculateNormals","smoothByNormals","smoothOut","refine","refineToLength","refineToTolerance","setProperties","setTolerance","asOriginal","trimByPlane","split","splitByPlane","slice","project","hull"],sr=["square","circle","union","difference","intersection","compose","ofPolygons","hull"],ar=["add","subtract","intersect","rectClip","decompose","transform","translate","rotate","scale","mirror","simplify","offset","hull"],ur=["show","only","setMaterial"];function Ue(w,_,b,o,M){const E=M[w],H=b?E:E.prototype;for(const B of _){const F=H[B];H[B]=function(...z){const N=F(...z);return o.push(N),N}}}function cr(w){const _=[];Ue("Manifold",ir,!1,_,w),Ue("Manifold",or,!0,_,w),Ue("CrossSection",ar,!1,_,w),Ue("CrossSection",sr,!0,_,w);for(const b of ur){const o=w[b];w[b]=function(...M){const E=o(...M);return _.push(E),E}}return w.cleanup=function(){for(const b of _)if(b instanceof Array)for(const o of b)o.delete();else b.delete();_.length=0},w.clone=function(b){return b.asOriginal()},w}function lr(w){return w*180/Math.PI}const Pe=14.1;function st(w,_,b,o,M=!0){const E=w.Manifold;let H=[];for(let B=0;B<(M?o.length:o.length-1);B++){const F=o[B],z=o[(B+1)%o.length],N=z.x-F.x,te=z.y-F.y,ve=lr(Math.atan2(te,N)),R=Math.sqrt(N*N+te*te),he=E.extrude(_,R).rotate(90,0,90).rotate(0,0,ve).translate(F.x,F.y,0);H.push(he);const J=E.revolve(b,36).rotate(0).translate(z.x,z.y,0);H.push(J)}return H}function Mt({helper:w,size:_,roundRadius:b,center:o=[0,0]}){const M=w.CrossSection,E=[M.circle(b,16).translate(-_[0]/2+b+o[0],-_[1]/2+b+o[1]),M.circle(b,16).translate(_[0]/2-b+o[0],-_[1]/2+b+o[1]),M.circle(b,16).translate(_[0]/2-b+o[0],_[1]/2-b+o[1]),M.circle(b,16).translate(-_[0]/2+b+o[0],_[1]/2-b+o[1])],H=M.hull(E);for(const B of E)B.delete();return H}function fr(w,_,b){const o=b.usbHeight,E=Mt({helper:w,size:[15,8],roundRadius:1.5}).extrude(100),H=Mt({helper:w,size:[9.5,o],roundRadius:1}).extrude(1.5);return E.translate(0,0,1.5).add(H).rotate(90,0,0).translate(-_.x,_.y,-o/2-b.switchBoardHeight-b.connectorHeight-b.controllerBoardHeight)}let at=0,Et=!1;self.onmessage=async w=>{try{w.data.type==="calculate"?await pr(w.data):w.data.type==="cancel"&&at++}catch(_){_.message!=="canceled"&&self.postMessage({type:"error",error:_.message})}};let se;async function dr(){const w=await nr();return w.setup(),se=cr(w),Et=!0,se}dr();async function G(w){if(await new Promise(_=>setTimeout(_,0)),w!==at)throw new Error("canceled")}async function pr(w){const _=at;for(;!Et;)await G(_);const{switches:b,topInnerLines:o,controller:M,caseOutlines:E,bottomOuterLines:H,topPlateOutlines:B,params:F,centerX:z,centerY:N,switchType:te,minStabilizer:ve}=w,R=F.topHeight+F.switchEmbankment,he=F.plateHeight,J=F.switchBoardHeight+F.connectorHeight+F.controllerBoardHeight,O=se.Manifold,q=se.CrossSection,He=q.ofPolygons(E.map(y=>[-y.x,y.y])),ce=B.map(y=>{const S=y.map(me=>[-me.x,me.y]);return q.ofPolygons(S)}),le=b.map(y=>q.square([Pe,Pe],!0).rotate(y.position.a).translate(-y.position.x,y.position.y)),we=q.difference([He,...ce,...le]).extrude(R+J).translate(0,0,-J),Be=ce.map(y=>q.difference([y.simplify(.01).offset(.1),...le]).extrude(he));let P=O.union([we,...Be]);await G(_);{const y={...P.asOriginal().translate(z,-N).setTolerance(.05).getMesh()};self.postMessage({type:"complete",result:y})}if(ve&&te.includes("mx")){const y=b.filter(S=>S.w>=19*ve).flatMap(S=>{const me=S.w/19,ft=[2,3,6,6.25,7].filter(xe=>xe<=me).pop(),X={2:23.876,3:38.1,6:95,"6.25":100,7:114.3}[ft.toString()];if(!X)return[];const dt=q.square([7.2,19],!0).extrude(R).translate(X/2,0,0),Je=q.square([7.2,19],!0).extrude(R).translate(-X/2,0,0),$e=q.square([X,2.5],!0).extrude(2.5).translate(0,-9.5+2.5/2,0);return[dt,Je,$e].map(xe=>xe.rotate(0,0,S.position.a).translate(-S.position.x,S.position.y,0))});P=O.difference([P,...y])}await G(_);const j=te.includes("mx")?O.cube([5,15.5,3.55+.002],!0).translate(0,0,1.775-.001):O.cube([15.5,5,F.switchEmbankment+.6+.002],!0).translate(0,0,(F.switchEmbankment+.6)/2-.001),re=b.map(y=>j.asOriginal().rotate(0,0,y.position.a).translate(-y.position.x,y.position.y,0));if(P=O.difference([P,...re]),await G(_),te.includes("choc2")&&F.switchEmbankment>0){const y=b.map(S=>q.square([Pe+1.6,Pe+1.6],!0).extrude(F.switchEmbankment).subtract(q.square([Pe,Pe],!0).extrude(F.switchEmbankment)).rotate(0,0,S.position.a).translate(-S.position.x,S.position.y,he));P=O.union([P,...y])}if(await G(_),M.ledPos){const y=O.cylinder(R+he,.75,.75,32).translate(-M.ledPos.x,M.ledPos.y,0);P=P.subtract(y)}await G(_);const ye=O.extrude(o.map(y=>[-y.x,y.y]),J).translate(0,0,-J);P=P.subtract(ye),await G(_);const ne=3.3-1.6,T=M.pinPos.map(y=>O.cylinder(ne,.45,.45,16).translate(-y.x,y.y));P=O.difference([P,...T]),await G(_);const fe=[[0,0],[-2,-4],[2,-4]],de=[[0,0],[0,-4],[2,-4]],Le=st(se,fe,de,E.map(y=>({x:-y.x,y:y.y}))).map(y=>y.mirror([0,0,1]).translate(0,0,R-2)),ze=st(se,fe,de,E.map(y=>({x:-y.x,y:y.y}))).map(y=>y.translate(0,0,-J+2)),Ne=B.flatMap(y=>st(se,fe,de,y.map(S=>({x:-S.x,y:S.y}))).map(S=>S.mirror([0,0,1]).translate(0,0,R-1)));P=O.difference([P,...Le,...ze,...Ne]),await G(_);const We=M.usbCenterline[0].x,qe=Math.min(...H.map(y=>y.y)),pe=9,Ge=O.cylinder(2,pe,pe,32,!0).subtract(O.cube([pe*2,pe*2,2],!0).translate([0,3,0])),ut=Ge.asOriginal().translate(-We-19,qe+pe-.7,-2),ct=Ge.translate(-We+19,qe+pe-.7,-2);P=O.difference([P,ut,ct]),await G(_),P=O.difference([P,...M.usbCenterline.map(y=>fr(se,y,F))]),await G(_),P=P.translate(z,-N,0);const lt={...P.setTolerance(.05).getMesh()};self.postMessage({type:"complete",result:lt}),se.cleanup()}var vr=Object.freeze({__proto__:null})})();
